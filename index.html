<script src="https://maps.google.com/maps/api/js?key=AIzaSyAGL_Xc8z1fTp8Na-stxE9u8ihnjEbkbbA">

</script>
<script src="game-lib.js">
</script>
<script src="init.js">
</script>
<script src="view.js">
</script>
<script src="sprintf.js">
</script>
<script src="bounds.js">
</script>
<script src="tiles.js">
</script>
<link rel="stylesheet" type="text/css" href="style.css">

<button id="plus">+</button>
<button id="minus">-</button>
<button id="north">N</button>
<button id="south">S</button>
<button id="east">E</button>
<button id="west">W</button>
<button id="darker">darker</button>
<button id="lighter">lighter</button>
<button id="solar">solar</button>
<button id="landuse">landuse</button>

<div id="google_map" style="width:1200px; height:600px"></div>

<textarea id="box" cols=80 rows=25></textarea>


<label for="command">Command</label>
<input type="text" name="command" id="command"><p>

<div id="response"></div>

<canvas id="game-canvas" width=1200px height=450px></canvas>
<!-- <script src="google-map-stuff.js"></script> -->
<script src="gametiles.js"></script>

<script>

// setup view
const mapDiv = document.querySelector('#google_map');
view.map = new google.maps.Map(mapDiv, myOptions);
updateView(view);

// setup buttons

let buttons = document.querySelectorAll('button');
for (var i = 0; i < buttons.length; i++) {buttons[i].addEventListener('click', viewController);}

console.log(myOptions);

// rect.setMap(map);

let socket = new WebSocket("wss://ws.terramapadventure.com:443/");

socket.onerror = function(evt) {
  console.log("<error>",dump(evt),"</error>");
}

let tileinfo = {};
let userinfo = {};
let tiledata = {};

console.log(userinfo);
recv_msg('{"tag": "user", "data": {"username": "foo", "x": 123, "y": 456}}');
console.log(userinfo);

var output = document.getElementById("response");
var tbox = document.querySelector('#box');
tbox.disabled = true;

socket.onopen = function () {console.log("socket is open");}

socket.onmessage = function (event) {
  console.log(event);
  tbox.innerHTML += event.data+"\n";
  }

var cmdLine = document.getElementById("command")
cmdLine.addEventListener("keydown", command);

function command(e) {
  if (e.key == "Enter") {
    console.log("ALPHA",cmdLine.value);
    // TODO: don't hardcode my name
    var hash = {message: cmdLine.value, user: "barrycarter"};
    console.log("BETA",JSON.stringify(hash));
    ws.send(JSON.stringify(hash));
    cmdLine.value = "";
  }
}



</script>